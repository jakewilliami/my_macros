%%% General Typesetting %%%

% General font stuff
\PassOptionsToPackage{utf8}{inputenc}
\RequirePackage{inputenc}
\RequirePackage{csquotes}
\PassOptionsToPackage{english}{babel}
\RequirePackage{babel}
\RequirePackage{geometry}

% Good amount of text
\RequirePackage{fullpage}

% Miscellaneous utility packages
\RequirePackage{ifthen}
\PassOptionsToPackage{protrusion=true}{microtype}
\RequirePackage{microtype}
\RequirePackage{etoolbox}
\RequirePackage{setspace}
\RequirePackage{xpatch}
\RequirePackage{multicol}
\RequirePackage{verbatim}
\RequirePackage{changepage}  % defines adjustwidth

% Line breaks in monospaced text
\PassOptionsToPackage{htt}{hyphenat}
\RequirePackage{hyphenat}

% Redefine title sections
\RequirePackage{titlesec}
\RequirePackage{titletoc}

% The all-important em dash
\AtEndPreamble{%
  \def\emdash{\discretionary{}{}{\kern 0.1em}---\discretionary{}{}{\kern 0.1em}}%
}

% Large penalties for widows and orphans
% https://en.wikipedia.org/wiki/Widows_and_orphans
\widowpenalty10000	
\clubpenalty10000

% Make various section headings use small caps
\addto\captionsenglish{%
  \renewcommand{\contentsname}{\scshape Contents}%
}
% TODO: make this dynamic for all sections?  Add subsubsection?
% Note that this formatting doesn't extent to ToC but that is fine
\titleformat{\section}[hang]{%
  \fontsize{14.4}{18}\scshape\bfseries%
}{\thesection}{1em}{}[]
\titleformat{\subsection}[hang]{%
  \fontsize{12}{14}\scshape\bfseries%
}{\thesubsection}{1em}{}[]

% Make paragraph headings use italics
% https://tex.stackexchange.com/a/469869
\titleformat*{\paragraph}{\itshape\mdseries}

% Make title near the start of the document (without erroring)
% https://tex.stackexchange.com/a/120241/181375
% https://tex.stackexchange.com/a/576765/
\AtBeginDocument{%
  \let\default@color\current@color%
  \maketitle%
}

%%% End General Typesetting %%%
